
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Membership Upgrade - KBG Crypto</title>

    <script>
    // Protect all pages - redirect to login if not authenticated
    if (!localStorage.getItem('currentUser')) {
        window.location.href = 'index.html';
    } else {
        const user = JSON.parse(localStorage.getItem('currentUser'));
        // Optional: extra check (in case someone tampers with storage)
        if (user.username !== "Rose2317") {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
    }
    </script>

    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Toastr CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-left">
                <button class="back-btn" onclick="window.history.back()">‚Üê</button>
            </div>
            <div class="header-center">Membership Upgrade</div>
        </header>

        <!-- Urgent Alert Banner -->
        <div class="urgent-alert-banner">
            <div class="urgent-icon">‚ö†Ô∏è</div>
            <h3>Immediate Action Required!</h3>
            <p>Your current V4 membership has expired. All VIP benefits are currently suspended.</p>
            <p>Renew immediately to restore full access and continue enjoying VIP6 privileges.</p>
        </div>

        <div class="membership-container">
            <!-- V4 ‚Äì Current but Expired -->
            <div class="membership-card vip4 current expired">
                <div class="vip-badge-large">V4</div>
                <div class="diamond-icon">üíé</div>
                <div class="price-tag">6,500.00 USDT</div>
                <div class="current-tag">Current Plan</div>
                <div class="expired-tag">Expired</div>
                <button class="btn-renew" data-plan="v4" data-amount="6500.00">Renew Now</button>
                <div class="vip-details">
                    <p class="withdraw-limit-bold">
                        <strong>Withdraw limit up to</strong> <span class="highlight-limit">4,000,000 USDT</span>
                    </p>
                    <ul class="benefits-list">
                        <li>Priority 24/7 VIP Support</li>
                        <li>Exclusive Trading Signals</li>
                        <li>0.5% lower trading fees</li>
                        <li>Personal account manager</li>
                    </ul>
                </div>
            </div>

            <!-- V1 -->
            <div class="membership-card vip1">
                <div class="vip-badge-large">V1</div>
                <div class="diamond-icon">üíé</div>
                <div class="price-tag">1,498.50 USDT</div>
                <button class="btn-purchase" data-plan="v1" data-amount="1498.50">Purchase</button>
                <div class="vip-details">
                    <p class="withdraw-limit-bold">
                        <strong>Withdraw limit up to</strong> <span class="highlight-limit">500,000 USDT</span>
                    </p>
                    <ul class="benefits-list">
                        <li>Basic 24/7 Support</li>
                        <li>Standard trading tools</li>
                        <li>1.5% trading fees</li>
                    </ul>
                </div>
            </div>

            <!-- V2 -->
            <div class="membership-card vip2">
                <div class="vip-badge-large">V2</div>
                <div class="diamond-icon">üíé</div>
                <div class="price-tag">3,000.00 USDT</div>
                <button class="btn-purchase" data-plan="v2" data-amount="3000.00">Purchase</button>
                <div class="vip-details">
                    <p class="withdraw-limit-bold">
                        <strong>Withdraw limit up to</strong> <span class="highlight-limit">1,500,000 USDT</span>
                    </p>
                    <ul class="benefits-list">
                        <li>Enhanced Support (Chat + Email)</li>
                        <li>Advanced charting tools</li>
                        <li>1.2% trading fees</li>
                        <li>Weekly market insights</li>
                    </ul>
                </div>
            </div>

            <!-- V3 -->
            <div class="membership-card vip3">
                <div class="vip-badge-large">V3</div>
                <div class="diamond-icon">üíé</div>
                <div class="price-tag">5,000.00 USDT</div>
                <button class="btn-purchase" data-plan="v3" data-amount="5000.00">Purchase</button>
                <div class="vip-details">
                    <p class="withdraw-limit-bold">
                        <strong>Withdraw limit up to</strong> <span class="highlight-limit">2,500,000 USDT</span>
                    </p>
                    <ul class="benefits-list">
                        <li>Priority Support (Dedicated Line)</li>
                        <li>Pro-level analytics</li>
                        <li>0.8% trading fees</li>
                        <li>Daily premium signals</li>
                        <li>Early access to new features</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Modal (FIXED WALLET ADDRESS DISPLAY) -->
    <div id="payment-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content payment-modal-content glass-card">
            <div class="modal-header">
                <h2 class="modal-title">Payment for VIP <span id="modal-plan-level">V1</span></h2>
                <button class="modal-close" onclick="closePaymentModal()">√ó</button>
            </div>

            <div class="modal-body">
                <!-- BTC Price Display -->
                <div class="btc-price-display" id="btc-price-display" style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.2); border-radius: 12px; padding: 15px; margin-bottom: 20px; text-align: center;">
                    <div style="color: #fbbf24; font-size: 0.9rem; font-weight: 600; margin-bottom: 5px;">Current Bitcoin Price</div>
                    <div style="color: #fbbf24; font-size: 1.2rem; font-weight: 800; font-family: 'Courier New', monospace;" id="btc-price">$95,207.00</div>
                </div>

                <!-- Payment Summary -->
                <div class="modal-summary-box">
                    <div class="summary-item">
                        <span class="summary-label">Required Amount</span>
                        <span class="summary-value highlight" id="modal-plan-amount">1,498.50 USDT</span>
                    </div>
                    <div class="summary-divider"></div>
                    <div class="summary-item">
                        <span class="summary-label">BTC Equivalent</span>
                        <span class="summary-value" id="btc-equivalent-amount">0.0157 BTC</span>
                    </div>
                </div>

                <!-- Payment Methods -->
                <div class="payment-methods-section">
                    <h3 class="section-title">Select Payment Method</h3>
                    <div class="methods-grid">
                        <button class="method-card active" data-method="usdt">
                            <div class="method-icon-container">
                                <span class="method-icon crypto-icon">USDT</span>
                            </div>
                            <div class="method-info">
                                <span class="method-name">USDT (TRC20)</span>
                                <span class="method-fee">Network: TRC20 ‚Ä¢ Fast & Low Fee</span>
                            </div>
                            <div class="method-check">‚úì</div>
                        </button>
                        <button class="method-card" data-method="bitcoin">
                            <div class="method-icon-container">
                                <span class="method-icon crypto-icon">BTC</span>
                            </div>
                            <div class="method-info">
                                <span class="method-name">Bitcoin</span>
                                <span class="method-fee">Network: BTC ‚Ä¢ Secure</span>
                            </div>
                            <div class="method-check">‚úì</div>
                        </button>
                    </div>
                </div>

                <!-- Wallet Details -->
                <div class="wallet-details-section">
                    <h3 class="section-title">Deposit Wallet Address</h3>
                    <div class="wallet-details-grid">
                        <div class="qr-section">
                            <div class="qr-container">
                                <img id="qr-code" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TYbNoqgjK4Zksqyo21nAsiYKzsB2aWJmbL" alt="QR Code" class="qr-code">
                            </div>
                            <p class="qr-note">Scan to deposit</p>
                        </div>
                        <div class="wallet-address-section">
                            <div class="address-header">
                                <span class="address-label">Wallet Address</span>
                                <span class="address-hint">(Click to copy)</span>
                            </div>
                            <!-- FIXED: Horizontal wallet address container -->
                            <div class="wallet-address-container-horizontal">
                                <div class="wallet-address-horizontal" id="wallet-address" onclick="copyWallet()">
                                  TYbNoqgjK4Zksqyo21nAsiYKzsB2aWJmbL
                                </div>
                                <button class="btn-copy-address-horizontal" onclick="copyWallet()">
                                    <span class="copy-icon">üìã</span> Copy Address
                                </button>
                            </div>
                            
                            <!-- FIXED: Network warning box with proper styling -->
                            <div class="network-warning-box">
                                <div class="warning-header">
                                    <span class="warning-icon">‚ö†</span>
                                    <span class="warning-title">Network Verification</span>
                                </div>
                                <div class="warning-content">
                                    Send only <strong id="current-method-name">USDT (TRC20)</strong> to this address. 
                                    Sending other assets or using wrong network will result in permanent loss.
                                </div>
                            </div>

                            <!-- Amount Instructions -->
                            <div class="amount-instructions" style="margin-top: 15px; padding: 12px; background: rgba(30, 41, 59, 0.5); border-radius: 8px;">
                                <div style="color: #a0aec0; font-size: 0.85rem;">
                                    <strong style="color: white;">Important:</strong> Send the exact amount shown above. 
                                    <span id="exact-amount-instruction">Send exactly 1,498.50 USDT</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Important Notice -->
                <div class="payment-notice">
                    <div class="notice-icon">‚ÑπÔ∏è</div>
                    <div class="notice-content">
                        <strong>Important:</strong> Payment will be verified automatically within 5-10 minutes after 3 network confirmations.
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="payment-actions">
                    <button class="btn-secondary" onclick="closePaymentModal()">Cancel</button>
                    <button class="btn-primary btn-payment-done" onclick="showConfirmPaymentModal()">
                        <span class="btn-icon">‚úì</span> I Have Made the Payment
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal (FULLY RESPONSIVE REDESIGN) -->
    <div id="confirm-payment-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content confirm-modal-content glass-card">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Payment Details</h2>
                <button class="modal-close" onclick="closeConfirmModal()">√ó</button>
            </div>

            <div class="modal-body">
                <!-- Payment Details Summary -->
                <div class="confirmation-summary">
                    <div class="confirmation-item">
                        <span class="confirmation-label">Plan</span>
                        <span class="confirmation-value plan-badge" id="confirm-plan">VIP V1</span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Amount</span>
                        <span class="confirmation-value amount-highlight" id="confirm-amount">1,498.50 USDT</span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">Method</span>
                        <span class="confirmation-value method-badge" id="confirm-method">USDT (TRC20)</span>
                    </div>
                    <div class="confirmation-item">
                        <span class="confirmation-label">BTC Equivalent</span>
                        <span class="confirmation-value" id="confirm-btc-equivalent">0.0157 BTC</span>
                    </div>
                    <div class="confirmation-item wallet-item">
                        <span class="confirmation-label">Wallet Address</span>
                        <div class="wallet-display-container-horizontal">
                            <div class="wallet-display-horizontal" id="confirm-wallet">TYbNoqgjK4Zksqyo21nAsiYKzsB2aWJmbL</div>
                            <button class="btn-copy-small" onclick="copyConfirmationWallet()">
                                <span class="copy-icon-small">üìã</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Warning Box -->
                <div class="confirmation-warning-box">
                    <div class="warning-header">
                        <span class="warning-icon-large">‚ö†Ô∏è</span>
                        <span class="warning-title">Critical Warning</span>
                    </div>
                    <div class="warning-content">
                        <p>‚Ä¢ Double-check the wallet address and network above.</p>
                        <p>‚Ä¢ Send exactly <strong id="confirm-exact-amount">1,498.50 USDT</strong> to the specified address.</p>
                        <p>‚Ä¢ Sending to a wrong address will result in <strong>permanent loss of funds</strong>.</p>
                        <p>‚Ä¢ This transaction is <strong>irreversible</strong> once confirmed on the blockchain.</p>
                    </div>
                </div>

                <!-- Confirmation Buttons -->
                <div class="confirmation-actions">
                    <button class="btn-cancel" onclick="closeConfirmModal()">Cancel</button>
                    <button class="btn-confirm-final" onclick="confirmPaymentFinal()">
                        <span class="btn-icon">‚úì</span> Confirm & Submit Payment
                    </button>
                </div>

                <!-- Help Text -->
                <div class="confirmation-help">
                    <span class="help-icon">‚ìò</span>
                    <span>Need help? Contact <a href="#" class="support-link">VIP Support</a></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Overlay -->
    <div id="success-overlay" class="success-overlay" style="display: none;">
        <div class="success-content glass-card">
            <div class="success-icon">‚úÖ</div>
            <h2>Payment Submitted!</h2>
            <p>Your plan will be activated within 5-10 minutes when system receive your payment.</p>
            <button class="btn-close-success" onclick="closeSuccessOverlay()">Close</button>
        </div>
    </div>

    <!-- Toast library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <style>
        /* ENHANCED MODAL STYLES FOR RESPONSIVENESS */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 16px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* PAYMENT MODAL */
        .payment-modal-content {
            background: linear-gradient(145deg, #0f172a, #1e293b);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            width: 100%;
            max-width: 520px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 24px 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #ffffff;
            margin: 0;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #a0aec0;
            font-size: 24px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }

        .modal-body {
            padding: 24px;
        }

        /* Payment Summary */
        .modal-summary-box {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .summary-label {
            color: #a0aec0;
            font-size: 0.95rem;
        }

        .summary-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: #ffffff;
        }

        .summary-value.highlight {
            color: #00d4aa;
        }

        .summary-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 16px 0;
        }

        /* Payment Methods */
        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 16px;
        }

        .methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .method-card {
            background: rgba(30, 41, 59, 0.7);
            border: 1.5px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .method-card:hover {
            background: rgba(56, 178, 172, 0.1);
            border-color: rgba(56, 178, 172, 0.3);
        }

        .method-card.active {
            background: rgba(56, 178, 172, 0.15);
            border-color: #38b2ac;
        }

        .method-icon-container {
            margin-right: 12px;
        }

        .method-icon.crypto-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .method-card[data-method="bitcoin"] .method-icon.crypto-icon {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .method-info {
            flex: 1;
        }

        .method-name {
            display: block;
            color: #ffffff;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .method-fee {
            display: block;
            color: #a0aec0;
            font-size: 0.85rem;
            margin-top: 2px;
        }

        .method-check {
            color: #38b2ac;
            font-size: 1.2rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .method-card.active .method-check {
            opacity: 1;
        }

        /* Wallet Details - FIXED FOR DESKTOP */
        .wallet-details-section {
            margin-bottom: 24px;
        }

        .wallet-details-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
        }

        @media (min-width: 640px) {
            .wallet-details-grid {
                grid-template-columns: 160px 1fr;
            }
        }

        .qr-container {
            background: white;
            padding: 12px;
            border-radius: 12px;
            display: inline-block;
        }

        .qr-code {
            width: 100%;
            height: auto;
            max-width: 136px;
            border-radius: 8px;
        }

        .qr-note {
            color: #a0aec0;
            font-size: 0.85rem;
            text-align: center;
            margin-top: 8px;
        }

        .wallet-address-section {
            display: flex;
            flex-direction: column;
        }

        .address-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .address-label {
            color: #a0aec0;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .address-hint {
            color: #38b2ac;
            font-size: 0.8rem;
            font-style: italic;
        }

        /* FIXED: Horizontal wallet address container */
        .wallet-address-container-horizontal {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 20px;
        }

        @media (min-width: 640px) {
            .wallet-address-container-horizontal {
                flex-direction: row;
                align-items: center;
                gap: 16px;
            }
        }

        .wallet-address-horizontal {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(56, 178, 172, 0.3);
            border-radius: 12px;
            padding: 18px;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            color: #ffffff;
            word-break: break-all;
            flex: 1;
            min-height: 56px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            line-height: 1.4;
        }

        .wallet-address-horizontal:hover {
            background: rgba(56, 178, 172, 0.1);
            border-color: #38b2ac;
            transform: translateY(-1px);
        }

        .btn-copy-address-horizontal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            color: white;
            padding: 16px 24px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 140px;
        }

        @media (max-width: 639px) {
            .btn-copy-address-horizontal {
                width: 100%;
            }
        }

        .btn-copy-address-horizontal:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .copy-icon {
            font-size: 1rem;
        }

        /* FIXED: Network warning box */
        .network-warning-box {
            background: rgba(245, 158, 11, 0.15);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 12px;
            padding: 18px;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .network-warning-box:hover {
            background: rgba(245, 158, 11, 0.2);
            border-color: rgba(245, 158, 11, 0.4);
        }

        .warning-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .warning-icon {
            font-size: 1.2rem;
            color: #f59e0b;
        }

        .warning-title {
            color: #fbbf24;
            font-weight: 700;
            font-size: 1rem;
        }

        .network-warning-box .warning-content {
            color: #fbbf24;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .network-warning-box .warning-content strong {
            color: #ffffff;
            font-weight: 700;
        }

        /* Payment Notice */
        .payment-notice {
            background: rgba(56, 178, 172, 0.1);
            border: 1px solid rgba(56, 178, 172, 0.2);
            border-radius: 10px;
            padding: 16px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 24px;
        }

        .notice-icon {
            font-size: 1.2rem;
            color: #38b2ac;
        }

        .notice-content {
            color: #a0aec0;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Payment Actions */
        .payment-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media (min-width: 480px) {
            .payment-actions {
                grid-template-columns: 1fr 2fr;
            }
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            padding: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4aa 0%, #009688 100%);
            border: none;
            border-radius: 12px;
            color: white;
            padding: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 212, 170, 0.4);
        }

        .btn-icon {
            font-size: 1.1rem;
        }

        /* CONFIRMATION MODAL */
        .confirm-modal-content {
            background: linear-gradient(145deg, #0f172a, #1e293b);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .confirmation-summary {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .confirmation-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .confirmation-item:last-child {
            border-bottom: none;
        }

        .confirmation-item.wallet-item {
            align-items: flex-start;
            flex-direction: column;
            gap: 12px;
        }

        @media (min-width: 480px) {
            .confirmation-item.wallet-item {
                flex-direction: row;
                align-items: center;
            }
        }

        .confirmation-label {
            color: #a0aec0;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .confirmation-value {
            color: #ffffff;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .plan-badge {
            background: rgba(56, 178, 172, 0.2);
            color: #38b2ac;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        .amount-highlight {
            color: #00d4aa;
            font-size: 1.1rem;
        }

        .method-badge {
            background: rgba(102, 126, 234, 0.2);
            color: #667eea;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        /* FIXED: Confirmation wallet display */
        .wallet-display-container-horizontal {
            display: flex;
            align-items: center;
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 12px 16px;
            gap: 12px;
        }

        @media (min-width: 480px) {
            .wallet-display-container-horizontal {
                max-width: 350px;
            }
        }

        .wallet-display-horizontal {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #ffffff;
            word-break: break-all;
            flex: 1;
            line-height: 1.4;
            padding: 4px 0;
        }

        .btn-copy-small {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 6px;
            color: #a0aec0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .btn-copy-small:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }

        .copy-icon-small {
            font-size: 0.9rem;
        }

        /* Confirmation Warning */
        .confirmation-warning-box {
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid rgba(220, 38, 38, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
        }

        .warning-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .warning-icon-large {
            font-size: 1.5rem;
            color: #f87171;
        }

        .warning-title {
            color: #f87171;
            font-weight: 700;
            font-size: 1rem;
        }

        .warning-content {
            color: #fca5a5;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .warning-content p {
            margin: 6px 0;
        }

        /* Confirmation Actions */
        .confirmation-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        @media (min-width: 480px) {
            .confirmation-actions {
                grid-template-columns: 1fr 2fr;
            }
        }

        .btn-cancel {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            padding: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-cancel:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-confirm-final {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border: none;
            border-radius: 12px;
            color: white;
            padding: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .btn-confirm-final:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.4);
        }

        /* Confirmation Help */
        .confirmation-help {
            text-align: center;
            color: #a0aec0;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .help-icon {
            font-size: 0.9rem;
        }

        .support-link {
            color: #38b2ac;
            text-decoration: none;
            font-weight: 600;
        }

        .support-link:hover {
            text-decoration: underline;
        }

        /* Success Overlay */
        .success-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            padding: 16px;
        }

        .success-content {
            background: linear-gradient(145deg, #0f172a, #1e293b);
            border: 1px solid rgba(0, 212, 170, 0.3);
            border-radius: 20px;
            padding: 40px 32px;
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .success-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            color: #00d4aa;
        }

        .success-content h2 {
            color: #ffffff;
            font-size: 1.8rem;
            margin-bottom: 16px;
        }

        .success-content p {
            color: #a0aec0;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .btn-close-success {
            background: linear-gradient(135deg, #00d4aa 0%, #009688 100%);
            border: none;
            border-radius: 12px;
            color: white;
            padding: 14px 32px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-close-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 170, 0.4);
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .modal-header {
                padding: 20px 16px 12px;
            }
            
            .modal-body {
                padding: 16px;
            }
            
            .modal-title {
                font-size: 1.3rem;
            }
            
            .summary-value {
                font-size: 1.2rem;
            }
            
            .methods-grid {
                grid-template-columns: 1fr;
            }
            
            .payment-actions, .confirmation-actions {
                grid-template-columns: 1fr;
            }
            
            .wallet-address-horizontal {
                padding: 16px;
                font-size: 0.85rem;
            }
            
            .btn-copy-address-horizontal {
                padding: 14px 20px;
                min-width: auto;
            }
        }
    </style>

    <script>
        // Wallet addresses (SAME AS DEPOSIT PAGE)
        const walletAddresses = {
            usdt: {
                address: "TYbNoqgjK4Zksqyo21nAsiYKzsB2aWJmbL",
                network: "USDT (TRC20)",
                qr: "https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=TYbNoqgjK4Zksqyo21nAsiYKzsB2aWJmbL",
                currency: "USDT",
                minAmount: 1500
            },
            bitcoin: {
                address: "bc1q80kd90frctf9kd6cymenftc6h767rvlw6gghms",
                network: "Bitcoin (BTC)",
                qr: "https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=bc1q80kd90frctf9kd6cymenftc6h767rvlw6gghms",
                currency: "BTC",
                minAmount: 0.016
            }
        };

        // Current BTC price and payment data
        let btcPrice = 95207; // USD price per BTC
        let currentPlanAmount = 0; // USDT amount for current plan
        let currentPlanName = '';
        let currentPaymentMethod = 'usdt';

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            fetchBTCPrice();
            setupPaymentMethods();
        });

        // Fetch live BTC price from CoinGecko
        async function fetchBTCPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');
                const data = await response.json();
                
                if (data.bitcoin && data.bitcoin.usd) {
                    btcPrice = data.bitcoin.usd;
                    updateBTCPriceDisplay();
                    updateBtcEquivalent();
                }
            } catch (error) {
                console.log('Using default BTC price:', btcPrice);
                updateBTCPriceDisplay();
                updateBtcEquivalent();
            }
            
            // Update price every 30 seconds
            setTimeout(fetchBTCPrice, 30000);
        }

        // Update BTC price display
        function updateBTCPriceDisplay() {
            const btcPriceElement = document.getElementById('btc-price');
            if (btcPriceElement) {
                btcPriceElement.textContent = `$${btcPrice.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            }
        }

        // Calculate and update BTC equivalent
        function updateBtcEquivalent() {
            if (currentPlanAmount > 0) {
                const btcEquivalent = currentPlanAmount / btcPrice;
                const btcEquivalentElement = document.getElementById('btc-equivalent-amount');
                const confirmBtcElement = document.getElementById('confirm-btc-equivalent');
                
                if (btcEquivalentElement) {
                    btcEquivalentElement.textContent = btcEquivalent.toFixed(4) + ' BTC';
                }
                if (confirmBtcElement) {
                    confirmBtcElement.textContent = btcEquivalent.toFixed(4) + ' BTC';
                }
                
                // Update instruction based on payment method
                updateExactAmountInstruction();
            }
        }

        // Setup payment method selection
        function setupPaymentMethods() {
            document.querySelectorAll('.method-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.method-card').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    
                    currentPaymentMethod = this.dataset.method;
                    updateWalletDetails();
                    updateExactAmountInstruction();
                });
            });
        }

        // Update wallet details based on selected method
        function updateWalletDetails() {
            const details = walletAddresses[currentPaymentMethod];
            if (!details) return;
            
            // Update wallet address
            document.getElementById('wallet-address').textContent = details.address;
            document.getElementById('confirm-wallet').textContent = details.address;
            
            // Update QR code
            document.getElementById('qr-code').src = details.qr;
            
            // Update network warning
            const methodNameElement = document.getElementById('current-method-name');
            const confirmMethodElement = document.getElementById('confirm-method');
            
            if (methodNameElement) {
                methodNameElement.textContent = details.network;
            }
            if (confirmMethodElement) {
                confirmMethodElement.textContent = details.network;
            }
            
            // Update button colors based on method
            const copyButton = document.querySelector('.btn-copy-address-horizontal');
            const paymentButton = document.querySelector('.btn-payment-done');
            
            if (currentPaymentMethod === 'bitcoin') {
                if (copyButton) {
                    copyButton.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
                    copyButton.onmouseenter = function() {
                        this.style.boxShadow = '0 5px 20px rgba(245, 158, 11, 0.4)';
                    };
                    copyButton.onmouseleave = function() {
                        this.style.boxShadow = 'none';
                    };
                }
                if (paymentButton) {
                    paymentButton.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
                    paymentButton.onmouseenter = function() {
                        this.style.boxShadow = '0 5px 20px rgba(245, 158, 11, 0.4)';
                    };
                    paymentButton.onmouseleave = function() {
                        this.style.boxShadow = 'none';
                    };
                }
            } else {
                if (copyButton) {
                    copyButton.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                    copyButton.onmouseenter = function() {
                        this.style.boxShadow = '0 5px 20px rgba(102, 126, 234, 0.4)';
                    };
                    copyButton.onmouseleave = function() {
                        this.style.boxShadow = 'none';
                    };
                }
                if (paymentButton) {
                    paymentButton.style.background = 'linear-gradient(135deg, #00d4aa 0%, #009688 100%)';
                    paymentButton.onmouseenter = function() {
                        this.style.boxShadow = '0 5px 20px rgba(0, 212, 170, 0.4)';
                    };
                    paymentButton.onmouseleave = function() {
                        this.style.boxShadow = 'none';
                    };
                }
            }
        }

        // Update exact amount instruction
        function updateExactAmountInstruction() {
            const instructionElement = document.getElementById('exact-amount-instruction');
            const confirmExactElement = document.getElementById('confirm-exact-amount');
            
            if (currentPaymentMethod === 'usdt') {
                if (instructionElement) {
                    instructionElement.textContent = `Send exactly ${currentPlanAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT`;
                }
                if (confirmExactElement) {
                    confirmExactElement.textContent = `${currentPlanAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT`;
                }
            } else {
                const btcEquivalent = currentPlanAmount / btcPrice;
                const usdtAmount = currentPlanAmount;
                if (instructionElement) {
                    instructionElement.textContent = `Send exactly ${btcEquivalent.toFixed(4)} BTC (‚âà$${usdtAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT)`;
                }
                if (confirmExactElement) {
                    confirmExactElement.textContent = `${btcEquivalent.toFixed(4)} BTC (‚âà$${usdtAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})} USDT)`;
                }
            }
        }

        // Open payment modal
        document.querySelectorAll('.btn-purchase, .btn-renew').forEach(btn => {
            btn.addEventListener('click', () => {
                const plan = btn.dataset.plan;
                const amount = parseFloat(btn.dataset.amount);
                
                if (!plan || !amount) {
                    toastr.error('Error: Plan or amount missing');
                    return;
                }
                
                currentPlanAmount = amount;
                currentPlanName = plan.toUpperCase();
                
                // Update modal content
                document.getElementById('modal-plan-level').textContent = plan.toUpperCase();
                document.getElementById('modal-plan-amount').textContent = amount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + ' USDT';
                
                // Reset to USDT by default
                document.querySelectorAll('.method-card').forEach(c => c.classList.remove('active'));
                document.querySelector('.method-card[data-method="usdt"]').classList.add('active');
                currentPaymentMethod = 'usdt';
                
                // Update all displays
                updateBTCPriceDisplay();
                updateBtcEquivalent();
                updateWalletDetails();
                updateExactAmountInstruction();
                
                // Show modal
                document.getElementById('payment-modal').style.display = 'flex';
                document.body.style.overflow = 'hidden';
            });
        });

        // Close payment modal
        function closePaymentModal() {
            document.getElementById('payment-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Copy wallet from payment modal
        function copyWallet() {
            const address = document.getElementById('wallet-address').textContent;
            navigator.clipboard.writeText(address).then(() => {
                toastr.success('Wallet address copied to clipboard!', '', { 
                    timeOut: 2000,
                    positionClass: 'toast-top-center'
                });
            }).catch(() => {
                toastr.error('Failed to copy address');
            });
        }

        // Copy wallet from confirmation modal
        function copyConfirmationWallet() {
            const address = document.getElementById('confirm-wallet').textContent;
            navigator.clipboard.writeText(address).then(() => {
                toastr.success('Wallet address copied to clipboard!', '', { 
                    timeOut: 2000,
                    positionClass: 'toast-top-center'
                });
            }).catch(() => {
                toastr.error('Failed to copy address');
            });
        }

        // Show confirmation modal
        function showConfirmPaymentModal() {
            // Update confirmation modal content
            document.getElementById('confirm-plan').textContent = 'VIP ' + currentPlanName;
            document.getElementById('confirm-amount').textContent = currentPlanAmount.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}) + ' USDT';
            
            // Update BTC equivalent
            const btcEquivalent = currentPlanAmount / btcPrice;
            document.getElementById('confirm-btc-equivalent').textContent = btcEquivalent.toFixed(4) + ' BTC';
            
            // Update method
            const methodName = currentPaymentMethod === 'usdt' ? 'USDT (TRC20)' : 'Bitcoin (BTC)';
            document.getElementById('confirm-method').textContent = methodName;
            
            // Update exact amount warning
            updateExactAmountInstruction();
            
            // Switch modals
            document.getElementById('payment-modal').style.display = 'none';
            document.getElementById('confirm-payment-modal').style.display = 'flex';
        }

        // Close confirmation modal
        function closeConfirmModal() {
            document.getElementById('confirm-payment-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Final confirmation ‚Üí Show success overlay
        function confirmPaymentFinal() {
            closeConfirmModal();

            const successOverlay = document.getElementById('success-overlay');
            successOverlay.style.display = 'flex';

            // Auto-close after 8 seconds
            setTimeout(() => {
                successOverlay.style.display = 'none';
                document.body.style.overflow = 'auto';
            }, 8000);
        }

        // Close success overlay
        function closeSuccessOverlay() {
            document.getElementById('success-overlay').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modals on outside click
        document.querySelectorAll('.modal-overlay').forEach(modal => {
            modal.addEventListener('click', e => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        });

        // Toastr configuration
        toastr.options = {
            positionClass: 'toast-top-center',
            progressBar: true,
            timeOut: 3000,
            closeButton: true,
            newestOnTop: true
        };
    </script>
</body>
</html>
